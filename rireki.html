<!DOCTYPE html>
<html>
<head>
<title>rireki.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="%E3%82%B5%E3%83%B3%E3%83%97%E3%83%AB">サンプル</h1>
<p><img src="img/screenshot_20241204_142216.png" alt="サンプル"></p>
<h1 id="%E9%A0%86%E4%BD%8D%E8%A1%A8">順位表</h1>
<p><img src="img/screenshot_20241204_142225.png" alt="順位"></p>
<h1 id="visualizer">visualizer</h1>
<p>30件のデータは
末尾53990</p>
<pre class="hljs"><code><div>30 10 5574
107078 94773
79170 52618
38499 43784
38889 103253
48050 92863
87311 53642
39468 72779
95373 47388
87661 43610
79937 100401
48568 72568
86446 36184
92859 49189
44133 43911
41705 62819
65063 87596
92801 47922
106492 70387
74899 75881
62505 93339
89927 62746
42386 76610
51314 63771
51239 61854
62275 53392
74930 70895
70921 67643
78889 81423
87676 42560
53990 52818
</div></code></pre>
<pre class="hljs"><code><div>100000 100000  
</div></code></pre>
<!-- ![gif](img/vis.gif) -->
<!-- ![png](img/vis.png) -->
<p><img src="img/greedy0_sc.png" alt="greedy">
<img src="img/sample_sc.png" alt="sample"></p>
<h1 id="%E6%B3%A8%E6%84%8F">注意</h1>
<ul>
<li>「提出」の得点は低い方が良い点数となる
<ul>
<li>絶対スコア**である</li>
<li>低い方が良い点数となる。</li>
</ul>
</li>
<li>「順位表」の点数は高い方がいい点数となる
<ul>
<li>相対スコア**である</li>
<li>高い方がいい点数となる。</li>
</ul>
</li>
<li>c.f. サンプルプログラムが今の所一よ良い順位を弾き出す(2024/12/04)</li>
</ul>
<h1 id="%E4%BD%9C%E6%88%A63%E6%97%A5%E7%9B%AE">作戦(3日目)</h1>
<ul>
<li>まずはランダム(サンプルプログラム)の改善</li>
<li>ランダムにためしまくっていいやつを採択する</li>
</ul>
<h2 id="%E3%82%B9%E3%82%B3%E3%82%A2%E3%82%92%E8%87%AA%E5%AE%B6%E3%81%A7%E8%A8%88%E7%AE%97%E3%81%97%E3%81%9F%E3%81%84">スコアを自家で計算したい</h2>
<ul>
<li>
<p>これに苦戦
<img src="img/sousarei.png" alt="はばと高さをどう計算する？"></p>
</li>
<li>
<p>(U,0),(U,1),(U,2)だけに注目する</p>
</li>
<li>
<p><code>maxw</code>,<code>maxh</code>を計算できれば、めちゃくちゃ助かるが</p>
</li>
<li>
<p>どうやって計算したらいいのだろうか...</p>
</li>
<li>
<p>横にくっついてるリスト(U,1)の場合, <code>[0,1,3]</code></p>
</li>
<li>
<p>縦方向にくっついてるリスト(U,1)の場合, <code>[0,2]</code></p>
</li>
<li>
<p>を用意すれば, よさそうに見えるが、</p>
</li>
<li>
<p>(U,0)の場合を考えるとそれは面倒臭いことがわかる</p>
</li>
<li>
<p>横リスト[0,1]</p>
</li>
<li>
<p>縦リスト[0,2],[1,3]だけど、連結してなくても、回転なし、回転あり、回転なしがくっついて、幅が増えているケースもある(<code>sample.sc.png</code>)</p>
</li>
<li>
<p>結論: やっぱり、コストを前計算するのは難しい！！</p>
</li>
<li>
<p>近似するなら、</p>
</li>
<li>
<p>ランダムなら、値は分からなくても正方形にはなりそうだから、横にくっつくのと縦にくっつくのが平均<code>N//2</code>回になりそう</p>
</li>
</ul>
<h2 id="%E3%81%AA%E3%82%93%E3%81%A1%E3%82%83%E3%81%A3%E3%81%A6%E8%BF%91%E4%BC%BC%E3%82%B3%E3%82%B9%E3%83%88%E3%82%82%E6%B1%82%E3%82%81%E3%82%8B%E4%BD%9C%E6%88%A6">なんちゃって近似コストも求める作戦</h2>
<ul>
<li>回転の有無だけ知っておく</li>
<li>回転するなら軸を入れ替えて平均をとる、</li>
<li><code>avgw,avgh=(平均長方形辺長)*(N//2)</code>こ
<ul>
<li>(N=30なら15こ縦と横に並ぶ)</li>
</ul>
</li>
<li><code>avgw+avgh</code>を自前で求めた近似コストとする</li>
<li>Nこの長方形のmaxw,maxhをO(N)で求めて2で割る→近似が荒すぎる</li>
</ul>
<h2 id="%E4%BD%9C%E6%88%A6%E3%82%92%E7%B0%A1%E5%8D%98%E3%81%AB%E3%81%99%E3%82%8B">作戦を簡単にする</h2>
<ul>
<li>クエリを送って帰ってくる、コストを使って改善する</li>
<li>これは, 2回目はまだできない</li>
<li>最後のクエリ(T)でbestscoreの詰め込み方を送リたいから、</li>
<li><strong>bestscoreを求めた際、ダンボールの詰め込み方(<code>prdb</code>)も保存しておく必要がある</strong></li>
<li>3回目
<ul>
<li>(1回目のコスト)-(2回目のコスト)=(-):
<ul>
<li>コストは小さい方がいいから, 1回目のほうがいい.</li>
</ul>
</li>
<li>1回目のスコアをbestscoreに保存する</li>
<li><code>bestprdb</code>も保存する</li>
<li>3回目をクエリに送る</li>
<li>(1回目のスコア)-(2回目のスコア)=(+):
<ul>
<li>コストは小さい方がいいから, 2回目のほうがいい.</li>
</ul>
</li>
<li>2回目のスコアをbestscoreに保存する</li>
<li><code>bestprdb</code>も保存する</li>
<li>3回目の詰め込みを実行しをクエリに送る</li>
</ul>
</li>
<li>4回目
<ul>
<li>(bestscore)-(3回目のコスト)=(-):
<ul>
<li>コストは小さい方がいいから, bestscoreのほうがいい.</li>
</ul>
</li>
<li>更新なし</li>
<li>(bestscore)-(3回目のスコア)=(+):
<ul>
<li>コストは小さい方がいいから, 3回目のほうがいい.</li>
</ul>
</li>
<li>3回目のスコアをbestscoreに保存する</li>
</ul>
</li>
<li><code>bestprdb</code>も保存する
<ul>
<li>4回目の詰め込みを実行しクエリに送る</li>
</ul>
</li>
<li>5回目
<ul>
<li>差分が(-)の場合は更新なしなので記載を省く</li>
<li>(bestscore)-(4回目のスコア)=(+):
<ul>
<li>コストは小さい方がいいから, 4回目のほうがいい.</li>
</ul>
</li>
<li>4回目のスコアをbestscoreに保存する</li>
<li><code>bestprdb</code>も保存する</li>
<li>5回目の詰め込みを実行しクエリに送る</li>
</ul>
</li>
</ul>
<h1 id="%E7%B5%90%E6%9E%9C4%E6%97%A5%E7%9B%AE">結果(4日目)</h1>
<p>上記を実装したが, 順位はちょっと下がった.</p>
<p>結局サンプルプログラムが一番いいのだが,
まぁ一直線に積み重ねるよりはマシ.</p>
<p><img src="img/randkaizen.png" alt="randomkaizen">
<img src="img/randkaizen_teisyutu.png" alt="提出"></p>
<h2 id="%E3%82%82%E3%81%A3%E3%81%A8%E5%8D%98%E7%B4%94%E3%81%AB%E3%81%99%E3%82%8B">もっと単純にする</h2>
<ul>
<li>
<p>サンプルプログラムが優秀なので,さサイコロを振って改善</p>
</li>
<li>
<p>ターンごとに違うランダムの詰め込みを送って, 一番コストが低いものを<code>turn==T-1</code>で出力(<code>query(bestprdb)</code>)</p>
</li>
<li>
<p>手順</p>
<ul>
<li><code>turn==0,1</code>:
<ul>
<li>まだ2回目時点では差分をとってこれない</li>
<li><code>scoreT0=W0+H0</code>,</li>
<li><code>ScoreT1=W1,H1</code>,</li>
<li><code>T0prdb</code>,</li>
<li><code>T1prdb</code></li>
<li>を保存</li>
</ul>
</li>
</ul>
</li>
<li>
<p><code>turn==3</code>:</p>
<ul>
<li>
<pre class="hljs"><code><div> <span class="hljs-keyword">if</span> scoreT0 - scoreT1 &lt; <span class="hljs-number">0</span>:
     bestscore = scoreT0
     bestprdb = deepcopy(T0prdb)
 <span class="hljs-keyword">else</span>:
     bestscore = scoreT1
     bestprdb = deepcopy(T1prdb)
</div></code></pre>
</li>
</ul>
</li>
</ul>
<h2 id="%E7%B5%90%E6%9E%9C">結果</h2>
<p>誤差か分からんが, サンプルプログラムには勝てない。</p>
<ul>
<li>改善できていない</li>
<li>どこかロジックが破綻している
とみるべきな気がする</li>
</ul>
<p><img src="img/sampkaisubmit.png" alt="">
<img src="img/sampkaizyuni.png" alt=""></p>
<h2 id="5%E6%97%A5%E7%9B%AE">5日目</h2>
<p>サンプルについて以下のように書き換えるとスコアが上がった
<code>rng = random.Random(123)</code></p>
<p><img src="img/sampseed123.png" alt="順位"></p>

</body>
</html>
