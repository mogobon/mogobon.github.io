tags: [アルゴリズム]
---


# 二分探索

* ある長さ$N$の数列$A=\lbrace A_0,A_1,\cdots,A_{N-1}\rbrace$を考えます。
* 各添字$i$に対して真理値を返す判定関数$f(i)$を定義します。
  * これは「$i$を決めると対応する値$A_i$が定まり、その値に基づいて$f(i)$の真偽が決まる」という意味です。
* もし$f(i)$がある添字$i^{\ast}$を境に一様に切り替わるなら、このような数列は**単調性を持つ**と言います。
  * （例えば$i<i^{\ast}$では常に偽、$i\geq i^{\ast}$では常に真）
* 単調性を持つ場合、境界$i^{\ast}$は二分探索を用いて時間計算量$O(\log N)$で求めることができます。

### 例

* 長さ$N$の数列$A=\lbrace A_0,A_1,\cdots,A_{N-1}\rbrace$ が単調増加列のとき、$A_{i} \geq k$ となる最小の $i$ を、時間計算量${O(\log N)}$で求めることができます。

```python
ok,ng = n,-1
while abs(ok-ng) > 1:
    mid = (ok+ng) >> 1
    if f(mid) >= k:
        ok = mid
    else:
        ng = mid
```

次は同じものです。
* $A_i\geq k$となる最小の${i}$
* $A_i< k$となる要素の個数
* `bisect_left(A, k)`

同様にして、次は同じものです。

* $A_i > k$となる最小の$i$
* $A_i \leq k$となる要素の個数
* `bisect_right(A, k)`